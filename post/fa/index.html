<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head><script src="/RExample/livereload.js?mindelay=10&amp;v=2&amp;port=34193&amp;path=RExample/livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Factor analysis (FA) - Example R codes for BIOS 850 &amp; 880</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="LYQG" />
  <meta name="description" content="" />
<meta name="keywords" content="Factor analysis" />







<meta name="generator" content="Hugo 0.126.2" />


<link rel="canonical" href="http://localhost:34193/RExample/post/fa/" />





<link rel="icon" href="/RExample/favicon.ico" />











<link rel="stylesheet" href="/RExample/sass/jane.min.de22abc00de44766eebd1054fd9e0b254b071f89d5019044f893c484a9249a8d.css" integrity="sha256-3iKrwA3kR2buvRBU/Z4LJUsHH4nVAZBE&#43;JPEhKkkmo0=" media="screen" crossorigin="anonymous">







<meta property="og:url" content="http://localhost:34193/RExample/post/fa/">
  <meta property="og:site_name" content="Example R codes for BIOS 850 &amp; 880">
  <meta property="og:title" content="Factor analysis (FA)">
  <meta property="og:description" content="Example R codes for BIOS 850 &amp; 880">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-01-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-15T00:00:00+00:00">
    <meta property="article:tag" content="Factor Analysis">

  <meta itemprop="name" content="Factor analysis (FA)">
  <meta itemprop="description" content="Example R codes for BIOS 850 &amp; 880">
  <meta itemprop="datePublished" content="2024-01-15T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-15T00:00:00+00:00">
  <meta itemprop="wordCount" content="3697">
  <meta itemprop="keywords" content="Factor analysis">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Factor analysis (FA)">
  <meta name="twitter:description" content="Example R codes for BIOS 850 &amp; 880">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Example R codes for BIOS 850 & 880</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/about/">About</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/">external-link</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="http://localhost:34193/RExample/">
              docs
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="http://localhost:34193/RExample/post/ab/">AdaBoost</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/bcart/">Bagged Classification And Regression Trees（Bagged CART)</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/ct/">Classification trees</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/ca/">Cluster analysis</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/en/">Elastic Net</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/gb/">Gradient boosting</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/gbm/">Gradient Boosting Machine（GBM)</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/knn/">K Nearest Neighbors (KNN)</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/nb/">Naive Bayes</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/nn/">Neural network</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/rf/">Random forest</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/rt/">Regression trees</a>
              </li>
            
              <li>
                <a href="http://localhost:34193/RExample/post/svm/">Support vector machine (SVM)</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Example R codes for BIOS 850 & 880
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/about/">About</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:34193/RExample/">external-link</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          <a class="menu-item-link menu-parent" href="http://localhost:34193/RExample/">docs</a>
          <ul class="submenu">
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/ab/">AdaBoost</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/bcart/">Bagged Classification And Regression Trees（Bagged CART)</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/ct/">Classification trees</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/ca/">Cluster analysis</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/en/">Elastic Net</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/gb/">Gradient boosting</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/gbm/">Gradient Boosting Machine（GBM)</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/knn/">K Nearest Neighbors (KNN)</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/nb/">Naive Bayes</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/nn/">Neural network</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/rf/">Random forest</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/rt/">Regression trees</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:34193/RExample/post/svm/">Support vector machine (SVM)</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight wallpaper">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Factor analysis (FA)</h1>
      

      <div class="post-meta">
  <div class="post-meta-author">
    by
      LYQG
    
  </div>

  <div class="post-meta-time">
    <time datetime="2024-01-15">
      2024-01-15
    </time>
  </div>

  


  <div class="post-meta__right">
    

    <div class="post-meta-category">
        <a href="http://localhost:34193/RExample/categories/factor-analysis/"> Factor analysis </a>
          
      </div>


    
    


    
    
  </div>
</div>

    </header>

    
    


    
    <div class="post-content">
      <h2 id="1-package-installation">1. Package installation</h2>
<p>We will use functions in the R package <code>psych</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">require</span>(psych)) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;psych&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">require</span>(car)) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;car&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">require</span>(ElemStatLearn)) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;ElemStatLearn&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">require</span>(GPArotation)) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;GPArotation&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(psych)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ElemStatLearn)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(car)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(GPArotation)
</span></span></code></pre></div><h2 id="2-example-data">2. Example data</h2>
<p>To compare with the principal component analysis (PCA) method, we&rsquo;ll still use the prostate dataset. The Stanford University Medical Center provided PSA (Prostate-Specific Antigen) data for 97 patients who underwent radical prostatectomy. Our goal is to build a predictive model using clinical test data to forecast post-operative PSA levels. The PSA level can be an effective prognostic indicator of the extent of recovery after surgery. Post-surgery, doctors will check patients&rsquo; PSA levels at various intervals and determine their recovery status using various formulas. A predictive model developed before surgery, combined with post-surgery data (not provided here), could enhance the diagnosis and treatment of prostate cancer and improve its prognosis.</p>
<p>Specifically, the dataset includes the following variables:</p>
<p>Here is the detailed description of the variables in the dataset:</p>
<ul>
<li><strong>lcavol</strong>: The logarithm of the tumor volume.</li>
<li><strong>lweight</strong>: The logarithm of the prostate weight.</li>
<li><strong>age</strong>: The age of the patient in years.</li>
<li><strong>bph</strong>: The logarithm of the amount of benign prostatic hyperplasia (BPH), which refers to non-cancerous enlargement of the prostate.</li>
<li><strong>svi</strong>: Seminal vesicle invasion, a binary indicator variable representing whether cancer cells have invaded the seminal vesicles beyond the prostate wall (1—Yes, 0—No).</li>
<li><strong>lcp</strong>: The logarithm of capsular penetration, indicating the extent to which cancer cells have spread beyond the prostate capsule.</li>
<li><strong>gleason</strong>: The patient&rsquo;s Gleason score, given by a pathologist after a biopsy (range 2–10), indicating the degree of variation in cancer cells—the higher the score, the more aggressive the cancer.</li>
<li><strong>pgg45</strong>: The percentage of Gleason scores that are 4 or 5.</li>
<li><strong>lpsa</strong>: The logarithm of the PSA (Prostate-Specific Antigen) level, which is the response variable.</li>
<li><strong>train</strong>: A logical vector for cancer status indicator.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">data</span>(prostate)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span>(prostate)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## &#39;data.frame&#39;:	97 obs. of  10 variables:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ lcavol : num  -0.58 -0.994 -0.511 -1.204 0.751 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ lweight: num  2.77 3.32 2.69 3.28 3.43 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ age    : int  50 58 74 58 62 50 64 58 47 63 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ lbph   : num  -1.39 -1.39 -1.39 -1.39 -1.39 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ svi    : int  0 0 0 0 0 0 0 0 0 0 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ lcp    : num  -1.39 -1.39 -1.39 -1.39 -1.39 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ gleason: int  6 6 7 6 6 6 6 6 6 6 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ pgg45  : int  0 0 20 0 0 0 0 0 0 0 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ lpsa   : num  -0.431 -0.163 -0.163 -0.163 0.372 ...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  $ train  : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">corPlot</span>(prostate, gr <span style="color:#f92672">=</span> <span style="color:#a6e22e">colorRampPalette</span>(<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;#2171B5&#34;</span>, <span style="color:#e6db74">&#34;white&#34;</span>, <span style="color:#e6db74">&#34;#B52127&#34;</span>)))
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/640.webp"></p>
<h2 id="factor-analysis">Factor Analysis</h2>
<p>Factor analysis is a statistical method used to describe variability among observed variables in terms of fewer unobserved variables called factors. This technique can be applied to both clinical data and covariance data. Here, we will illustrate factor analysis with two different types of data and compare their advantages and disadvantages.</p>
<h3 id="regular-data-analysis">Regular Data Analysis</h3>
<p>To determine the number of common factors to extract, we can use the <code>fa.parallel</code> function to assess the number of factors needed. Let&rsquo;s proceed by extracting two factors using the <code>fa</code> function. The format of the <code>fa</code> function is as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">fa</span>(r, nfactors<span style="color:#f92672">=</span>, n.obs<span style="color:#f92672">=</span>, rotate<span style="color:#f92672">=</span>, scores<span style="color:#f92672">=</span>, fm<span style="color:#f92672">=</span>)
</span></span></code></pre></div><p>Where:</p>
<ul>
<li><code>r</code> is the correlation matrix or the raw data matrix.</li>
<li><code>nfactors</code> specifies the number of factors to extract (default is 1).</li>
<li><code>n.obs</code> is the number of observations (required when inputting a correlation matrix).</li>
<li><code>rotate</code> specifies the rotation method (default is varimax).</li>
<li><code>scores</code> specifies whether to compute factor scores (default is not to compute).</li>
<li><code>fm</code> specifies the factor extraction method (default is minres, minimum residual).</li>
</ul>
<p>From the output, we see the loadings of each variable on the two factors, their communalities (h2), and uniquenesses (u2). The SS loadings, proportion variance, and cumulative variance show how much variance each factor explains.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Exploratory factor analysis of prostate data options(digits=2) determine</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># number of factors to extract</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fa.parallel</span>(prostate[, <span style="color:#ae81ff">-10</span>], fa <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;fa&#34;</span>, n.obs <span style="color:#f92672">=</span> <span style="color:#ae81ff">97</span>, n.iter <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, show.legend <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,
</span></span><span style="display:flex;"><span>    main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Scree plot with parallel analysis&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Parallel analysis suggests that the number of factors =  3  and the number of components =  NA</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">abline</span>(h <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, lwd <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;green&#34;</span>)
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/641.webp"></p>
<p>We performed both PCA and factor analysis to observe the number of principal components and factors. In PCA, the components retained are those with eigenvalues greater than 1, while in factor analysis, factors with eigenvalues greater than 0 are considered.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">fa.parallel</span>(prostate[, <span style="color:#ae81ff">-10</span>], fa <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;both&#34;</span>, n.obs <span style="color:#f92672">=</span> <span style="color:#ae81ff">97</span>, n.iter <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, show.legend <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>,
</span></span><span style="display:flex;"><span>    main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Scree plot with parallel analysis&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Parallel analysis suggests that the number of factors =  3  and the number of components =  2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">abline</span>(h <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, lwd <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;green&#34;</span>)
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/642.webp"></p>
<p>Exploratory factor analysis (EFA) can be performed using methods such as minimum residual (minres), principal axis factoring (PAF), weighted least squares (WLS), or maximum likelihood (ML). Among various methods for exploring latent variables in EFA, using ordinary least squares (OLS) to obtain the minimum residual solution (minres) is one of the better approaches. This often produces results very similar to maximum likelihood, even for poorly behaved matrices. A variant of minres is weighted least squares (WLS). Perhaps the most traditional technique is principal axis factoring (PAF). It involves decomposing the correlation matrix, then using the first n factors to estimate each variable&rsquo;s communality. These communalities are input on the diagonal, and the process is repeated until the diagonal sum of the correlation matrix no longer changes. Another estimation method is maximum likelihood. For well-behaved matrices, maximum likelihood factor analysis (using the <code>fa</code> or <code>fac</code> function) may be preferred. By using <code>fa</code> with <code>n.iter &gt; 0</code>, you can obtain bootstrapped confidence intervals for loadings and factor intercorrelations.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fa <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fa</span>(prostate[, <span style="color:#ae81ff">-10</span>], nfactors <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, rotate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span>, fm <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pa&#34;</span>)
</span></span><span style="display:flex;"><span>fa
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Factor Analysis using method =  pa</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Call: fa(r = prostate[, -10], nfactors = 3, rotate = &#34;none&#34;, fm = &#34;pa&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Standardized loadings (pattern matrix) based upon correlation matrix</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##          PA1   PA2   PA3   h2   u2 com</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol  0.78 -0.01 -0.27 0.68 0.32 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight 0.36  0.65 -0.12 0.57 0.43 1.6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age     0.32  0.38  0.25 0.31 0.69 2.7</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    0.15  0.64  0.20 0.47 0.53 1.3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi     0.67 -0.19 -0.25 0.55 0.45 1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp     0.81 -0.23 -0.10 0.72 0.28 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason 0.67 -0.17  0.45 0.68 0.32 1.9</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45   0.77 -0.20  0.45 0.83 0.17 1.8</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa    0.77  0.17 -0.33 0.73 0.27 1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                        PA1  PA2  PA3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## SS loadings           3.60 1.16 0.77</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Var        0.40 0.13 0.09</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Var        0.40 0.53 0.61</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Explained  0.65 0.21 0.14</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Proportion 0.65 0.86 1.00</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Mean item complexity =  1.6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Test of the hypothesis that 3 factors are sufficient.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the null model are  36  and the objective function was  4.37 with Chi Square of  403.19</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the model are 12  and the objective function was  0.33 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The root mean square of the residuals (RMSR) is  0.03 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The df corrected root mean square of the residuals is  0.05 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The harmonic number of observations is  97 with the empirical chi square  6.46  with prob &lt;  0.89 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The total number of observations was  97  with Likelihood Chi Square =  29.37  with prob &lt;  0.0035 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Tucker Lewis Index of factoring reliability =  0.855</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## RMSEA index =  0.122  and the 90 % confidence intervals are  0.067 0.18</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## BIC =  -25.52</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Fit based upon off diagonal values = 0.99</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Measures of factor score adequacy             </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                                                    PA1  PA2  PA3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Correlation of (regression) scores with factors   0.96 0.85 0.86</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Multiple R square of scores with factors          0.93 0.72 0.73</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Minimum correlation of possible factor scores     0.85 0.43 0.46</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">factor.plot</span>(fa, labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">rownames</span>(fa<span style="color:#f92672">$</span>loadings))
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/643.webp"></p>
<p>To visualize factor loadings, you can use a factor loading plot.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">fa.diagram</span>(fa, simple <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/644.webp"></p>
<p>Factor rotation is a crucial step in factor analysis that aims to simplify and interpret the factors by altering the factor loadings. Rotating the factors does not change the total variance explained by the factors, but it does change the contribution of each factor to the total variance explained. During rotation, you&rsquo;ll notice that the loadings either move further away from zero or closer to zero, which theoretically helps in identifying variables that are more strongly associated with each factor. This attempt to link variables with unique factors aids in understanding the underlying structure of the data.</p>
<p>Factor analysis is an unsupervised learning technique, so you&rsquo;re trying to understand the data rather than validate a hypothesis. Rotation assists in this endeavor. The most commonly used method for factor rotation is called varimax rotation. While there are other methods such as quartimax rotation and equamax rotation, we primarily discuss varimax rotation here. In my experience, no other method has provided better results than varimax rotation. However, you can experiment with different methods to determine which one suits your data best.</p>
<p>In varimax rotation, the goal is to maximize the total variance of the squared loadings. The varimax rotation process rotates the eigenvectors of the feature space and coordinates but does not change the position of the centroids.</p>
<p>Based on the output results, it&rsquo;s observed that the first factor has substantial loadings on six observed variables, the second factor has significant loadings on variables such as lweight and lbph, and the third factor has relatively smaller loadings with minor differences. Together, the two factors explain 73% of the data&rsquo;s variance. However, interpreting three factors might be challenging. Therefore, orthogonal selection for factor extraction should be considered.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Listing 14.7 - Factor extraction with orthogonal rotation</span>
</span></span><span style="display:flex;"><span>fa.varimax <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fa</span>(prostate[, <span style="color:#ae81ff">-10</span>], nfactors <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, rotate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;varimax&#34;</span>, fm <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pa&#34;</span>)
</span></span><span style="display:flex;"><span>fa.varimax
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Factor Analysis using method =  pa</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Call: fa(r = prostate[, -10], nfactors = 3, rotate = &#34;varimax&#34;, fm = &#34;pa&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Standardized loadings (pattern matrix) based upon correlation matrix</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##           PA1   PA3   PA2   h2   u2 com</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol   0.78  0.23  0.15 0.68 0.32 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight  0.29 -0.09  0.69 0.57 0.43 1.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age      0.06  0.25  0.49 0.31 0.69 1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    -0.07  0.04  0.68 0.47 0.53 1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi      0.70  0.24 -0.05 0.55 0.45 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp      0.72  0.45 -0.02 0.72 0.28 1.7</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason  0.27  0.77  0.10 0.68 0.32 1.3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45    0.35  0.83  0.10 0.83 0.17 1.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa     0.79  0.13  0.30 0.73 0.27 1.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                        PA1  PA3  PA2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## SS loadings           2.52 1.69 1.32</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Var        0.28 0.19 0.15</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Var        0.28 0.47 0.61</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Explained  0.46 0.31 0.24</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Proportion 0.46 0.76 1.00</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Mean item complexity =  1.3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Test of the hypothesis that 3 factors are sufficient.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the null model are  36  and the objective function was  4.37 with Chi Square of  403.19</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the model are 12  and the objective function was  0.33 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The root mean square of the residuals (RMSR) is  0.03 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The df corrected root mean square of the residuals is  0.05 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The harmonic number of observations is  97 with the empirical chi square  6.46  with prob &lt;  0.89 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The total number of observations was  97  with Likelihood Chi Square =  29.37  with prob &lt;  0.0035 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Tucker Lewis Index of factoring reliability =  0.855</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## RMSEA index =  0.122  and the 90 % confidence intervals are  0.067 0.18</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## BIC =  -25.52</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Fit based upon off diagonal values = 0.99</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Measures of factor score adequacy             </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                                                    PA1  PA3  PA2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Correlation of (regression) scores with factors   0.92 0.91 0.84</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Multiple R square of scores with factors          0.84 0.82 0.71</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Minimum correlation of possible factor scores     0.67 0.65 0.42</span>
</span></span></code></pre></div><p>To plot factor or cluster loadings and assign items to clusters based on their highest loadings, one can use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># plot factor solution</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">factor.plot</span>(fa.varimax, labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">rownames</span>(fa.varimax<span style="color:#f92672">$</span>loadings))
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/645.webp"></p>
<p>To visualize the rotated factor loadings, one can use the following codes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">fa.diagram</span>(fa.varimax, simple <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/646.webp"></p>
<h3 id="factor-analysis-with-covariance-data">Factor Analysis with Covariance Data</h3>
<p>We first calculate the covariance matrix of the prostate dataset, then determine the number of factors to extract. We observe that the results display both PCA and EFA outcomes. PCA suggests extracting two or three components, while EFA suggests extracting three factors. Note that in the code, we use fa=&ldquo;both&rdquo;, which will show both principal components and common factor analysis results in the factor diagram.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>p.cor <span style="color:#f92672">=</span> <span style="color:#a6e22e">cor</span>(prostate[, <span style="color:#ae81ff">-10</span>])
</span></span><span style="display:flex;"><span><span style="color:#75715e"># convert covariances to correlations</span>
</span></span><span style="display:flex;"><span>correlations <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">cov2cor</span>(p.cor)
</span></span><span style="display:flex;"><span>correlations
</span></span><span style="display:flex;"><span><span style="color:#75715e">##            lcavol   lweight       age         lbph         svi          lcp</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol  1.0000000 0.2805214 0.2249999  0.027349703  0.53884500  0.675310484</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight 0.2805214 1.0000000 0.3479691  0.442264395  0.15538491  0.164537146</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age     0.2249999 0.3479691 1.0000000  0.350185896  0.11765804  0.127667752</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    0.0273497 0.4422644 0.3501859  1.000000000 -0.08584324 -0.006999431</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi     0.5388450 0.1553849 0.1176580 -0.085843238  1.00000000  0.673111185</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp     0.6753105 0.1645371 0.1276678 -0.006999431  0.67311118  1.000000000</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason 0.4324171 0.0568821 0.2688916  0.077820447  0.32041222  0.514830063</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45   0.4336522 0.1073538 0.2761124  0.078460018  0.45764762  0.631528246</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa    0.7344603 0.4333194 0.1695928  0.179809404  0.56621822  0.548813175</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##            gleason      pgg45      lpsa</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol  0.43241706 0.43365225 0.7344603</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight 0.05688210 0.10735379 0.4333194</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age     0.26889160 0.27611245 0.1695928</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    0.07782045 0.07846002 0.1798094</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi     0.32041222 0.45764762 0.5662182</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp     0.51483006 0.63152825 0.5488132</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason 1.00000000 0.75190451 0.3689868</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45   0.75190451 1.00000000 0.4223159</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa    0.36898681 0.42231586 1.0000000</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 判断需要提取的公共因子个数 determine number of factors to extract</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fa.parallel</span>(correlations, n.obs <span style="color:#f92672">=</span> <span style="color:#ae81ff">97</span>, fa <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;both&#34;</span>, n.iter <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Scree plots with parallel analysis&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Parallel analysis suggests that the number of factors =  3  and the number of components =  2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">abline</span>(h <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, lwd <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;green&#34;</span>)
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/647.webp"></p>
<p>Factor rotation:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Listing 14.6 - Principal axis factoring without rotation</span>
</span></span><span style="display:flex;"><span>fa <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fa</span>(correlations, nfactors <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, rotate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span>, fm <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pa&#34;</span>)
</span></span><span style="display:flex;"><span>fa
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Factor Analysis using method =  pa</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Call: fa(r = correlations, nfactors = 3, rotate = &#34;none&#34;, fm = &#34;pa&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Standardized loadings (pattern matrix) based upon correlation matrix</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##          PA1   PA2   PA3   h2   u2 com</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol  0.78 -0.01 -0.27 0.68 0.32 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight 0.36  0.65 -0.12 0.57 0.43 1.6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age     0.32  0.38  0.25 0.31 0.69 2.7</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    0.15  0.64  0.20 0.47 0.53 1.3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi     0.67 -0.19 -0.25 0.55 0.45 1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp     0.81 -0.23 -0.10 0.72 0.28 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason 0.67 -0.17  0.45 0.68 0.32 1.9</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45   0.77 -0.20  0.45 0.83 0.17 1.8</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa    0.77  0.17 -0.33 0.73 0.27 1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                        PA1  PA2  PA3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## SS loadings           3.60 1.16 0.77</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Var        0.40 0.13 0.09</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Var        0.40 0.53 0.61</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Explained  0.65 0.21 0.14</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Proportion 0.65 0.86 1.00</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Mean item complexity =  1.6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Test of the hypothesis that 3 factors are sufficient.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the null model are  36  and the objective function was  4.37</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the model are 12  and the objective function was  0.33 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The root mean square of the residuals (RMSR) is  0.03 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The df corrected root mean square of the residuals is  0.05 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Fit based upon off diagonal values = 0.99</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Measures of factor score adequacy             </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                                                    PA1  PA2  PA3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Correlation of (regression) scores with factors   0.96 0.85 0.86</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Multiple R square of scores with factors          0.93 0.72 0.73</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Minimum correlation of possible factor scores     0.85 0.43 0.46</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Listing 14.7 - Factor extraction with orthogonal rotation</span>
</span></span><span style="display:flex;"><span>fa.varimax <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fa</span>(correlations, nfactors <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, rotate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;varimax&#34;</span>, fm <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pa&#34;</span>)
</span></span><span style="display:flex;"><span>fa.varimax
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Factor Analysis using method =  pa</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Call: fa(r = correlations, nfactors = 3, rotate = &#34;varimax&#34;, fm = &#34;pa&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Standardized loadings (pattern matrix) based upon correlation matrix</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##           PA1   PA3   PA2   h2   u2 com</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol   0.78  0.23  0.15 0.68 0.32 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight  0.29 -0.09  0.69 0.57 0.43 1.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age      0.06  0.25  0.49 0.31 0.69 1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    -0.07  0.04  0.68 0.47 0.53 1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi      0.70  0.24 -0.05 0.55 0.45 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp      0.72  0.45 -0.02 0.72 0.28 1.7</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason  0.27  0.77  0.10 0.68 0.32 1.3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45    0.35  0.83  0.10 0.83 0.17 1.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa     0.79  0.13  0.30 0.73 0.27 1.4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                        PA1  PA3  PA2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## SS loadings           2.52 1.69 1.32</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Var        0.28 0.19 0.15</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Var        0.28 0.47 0.61</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Explained  0.46 0.31 0.24</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Proportion 0.46 0.76 1.00</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Mean item complexity =  1.3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Test of the hypothesis that 3 factors are sufficient.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the null model are  36  and the objective function was  4.37</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the model are 12  and the objective function was  0.33 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The root mean square of the residuals (RMSR) is  0.03 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The df corrected root mean square of the residuals is  0.05 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Fit based upon off diagonal values = 0.99</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Measures of factor score adequacy             </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                                                    PA1  PA3  PA2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Correlation of (regression) scores with factors   0.92 0.91 0.84</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Multiple R square of scores with factors          0.84 0.82 0.71</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Minimum correlation of possible factor scores     0.67 0.65 0.42</span>
</span></span></code></pre></div><p>Oblique rotation to extract factors yields results that are significantly better than orthogonal rotation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Listing 14.8 - Factor extraction with oblique rotation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># install.packages(&#39;GPArotation&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(GPArotation)
</span></span><span style="display:flex;"><span>fa.promax <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">fa</span>(correlations, nfactors <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, rotate <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;promax&#34;</span>, fm <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pa&#34;</span>)
</span></span><span style="display:flex;"><span>fa.promax
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Factor Analysis using method =  pa</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Call: fa(r = correlations, nfactors = 3, rotate = &#34;promax&#34;, fm = &#34;pa&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Standardized loadings (pattern matrix) based upon correlation matrix</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##           PA1   PA3   PA2   h2   u2 com</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol   0.80  0.03  0.04 0.68 0.32 1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight  0.29 -0.22  0.68 0.57 0.43 1.6</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age     -0.06  0.24  0.49 0.31 0.69 1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    -0.15  0.03  0.71 0.47 0.53 1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi      0.72  0.08 -0.15 0.55 0.45 1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp      0.68  0.30 -0.13 0.72 0.28 1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason  0.05  0.79  0.04 0.68 0.32 1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45    0.12  0.83  0.02 0.83 0.17 1.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa     0.82 -0.10  0.21 0.73 0.27 1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                        PA1  PA3  PA2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## SS loadings           2.58 1.66 1.29</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Var        0.29 0.18 0.14</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Var        0.29 0.47 0.61</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Proportion Explained  0.47 0.30 0.23</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Cumulative Proportion 0.47 0.77 1.00</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  With factor correlations of </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##      PA1  PA3  PA2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## PA1 1.00 0.51 0.25</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## PA3 0.51 1.00 0.18</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## PA2 0.25 0.18 1.00</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Mean item complexity =  1.2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Test of the hypothesis that 3 factors are sufficient.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the null model are  36  and the objective function was  4.37</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The degrees of freedom for the model are 12  and the objective function was  0.33 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The root mean square of the residuals (RMSR) is  0.03 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The df corrected root mean square of the residuals is  0.05 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Fit based upon off diagonal values = 0.99</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Measures of factor score adequacy             </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                                                    PA1  PA3  PA2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Correlation of (regression) scores with factors   0.94 0.93 0.85</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Multiple R square of scores with factors          0.89 0.87 0.73</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Minimum correlation of possible factor scores     0.78 0.74 0.45</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># calculate factor loading matrix</span>
</span></span><span style="display:flex;"><span>fsm <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(oblique) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">class</span>(oblique)[2] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;fa&#34;</span> <span style="color:#f92672">&amp;</span> <span style="color:#a6e22e">is.null</span>(oblique<span style="color:#f92672">$</span>Phi)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">warning</span>(<span style="color:#e6db74">&#34;Object doesn&#39;t look like oblique EFA&#34;</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        P <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">unclass</span>(oblique<span style="color:#f92672">$</span>loading)
</span></span><span style="display:flex;"><span>        F <span style="color:#f92672">&lt;-</span> P <span style="color:#f92672">%*%</span> oblique<span style="color:#f92672">$</span>Phi
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">colnames</span>(F) <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;PA1&#34;</span>, <span style="color:#e6db74">&#34;PA2&#34;</span>, <span style="color:#e6db74">&#34;PA3&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>(F)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fsm</span>(fa.promax)
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                PA1        PA2        PA3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol  0.82473291 0.44227350 0.24555125</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight 0.34220476 0.04243046 0.70717334</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age     0.18477222 0.29736739 0.51524467</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    0.03268287 0.07473469 0.67218104</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi     0.72626068 0.41757206 0.04449359</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp     0.79912417 0.62091939 0.08992345</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason 0.45900614 0.82088146 0.18990904</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45   0.55288520 0.90185461 0.20082633</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa    0.82381653 0.35706958 0.39508870</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># factor scores</span>
</span></span><span style="display:flex;"><span>fa.promax<span style="color:#f92672">$</span>weights
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                  PA1         PA3         PA2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcavol   0.243980481  0.05617920  0.03965284</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lweight  0.063289015 -0.05858661  0.42084810</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## age      0.001136759  0.04500146  0.19707194</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lbph    -0.052983656  0.03009248  0.37132673</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## svi      0.161318100  0.01106634 -0.08257798</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lcp      0.299975224  0.08308988 -0.12679762</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## gleason -0.015790579  0.30869180  0.04827821</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## pgg45    0.041112967  0.62164473  0.07257584</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## lpsa     0.359024621 -0.10014835  0.15129501</span>
</span></span></code></pre></div><p>Visualize the rotated factor loadings.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># plot factor solution</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">factor.plot</span>(fa.promax, labels <span style="color:#f92672">=</span> <span style="color:#a6e22e">rownames</span>(fa.promax<span style="color:#f92672">$</span>loadings))
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/648.webp"></p>
<p>Comparing the factor analysis results with conventional clinical data, we find that the results obtained using oblique rotation are clearer and more in line with our expectations.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">fa.diagram</span>(fa.promax, simple <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span></code></pre></div><p><img alt="Fig1" src="/RExample/post/fa/649.webp"></p>
<h2 id="useful-packages-for-factor-analysis">Useful Packages for Factor Analysis</h2>
<p>The FactoMineR package not only provides PCA and EFA methods but also includes latent variable models. The FAiR package uses genetic algorithms to estimate factor analysis models, enhancing the ability to estimate model parameters and handle inequality constraints. The GPArotation package offers many factor rotation methods, while the nFactors package provides methods for determining the number of factors.</p>
<h2 id="other-related-methods">Other Related Methods</h2>
<p>Models with Prior Knowledge: Start with some prior knowledge, such as the number of factors behind the variables, the loadings of variables on factors, and the correlations between factors. Then, test these prior knowledge using collected data. This approach is known as Confirmatory Factor Analysis (CFA). Packages for CFA include sem, openMx, and lavaan. The ltm package can be used to fit latent variable models for items in tests and questionnaires.</p>
<p>Latent Class Models: When latent factors are considered categorical rather than continuous, they can be fitted using packages like FlexMix, lcmm, randomLCA, and poLC. The lcda package can perform latent class discriminant analysis, while lsa can conduct latent semantic analysis, a method used in natural language processing. The ca package provides functions for performing simple and multiple correspondence analysis.</p>
<p>R also contains numerous tools for Multidimensional Scaling (MDS).</p>
<h3 id="mds-methods">MDS Methods:</h3>
<ul>
<li>cmdscale() function can perform classical MDS.</li>
<li>isoMDS() function in the MASS package can perform nonlinear MDS.</li>
<li>The vegan package includes functions for both types of MDS.</li>
</ul>
<p><strong>MDS</strong>: Used to discover and explain the latent dimensions that underlie the similarities and distances between measurable objects.</p>
    </div>

    
    



    
    


    <footer class="post-footer">
      <div class="post-tags">
          <a href="http://localhost:34193/RExample/tags/factor-analysis/">Factor analysis</a>
            
        </div>


      
      <nav class="post-nav">
        
          <a class="prev" href="/RExample/post/ca/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Cluster analysis</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/RExample/post/pca/">
            <span class="next-text nav-default">Principle component analysis (PCA)</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  


  
  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:lyqglyqg@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="http://lyqg.github.io/" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="http://localhost:34193/RExample/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
  
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2023 -
    2024
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        lyqg
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/RExample/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/RExample/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/RExample/js/main.fe83e11b4fbc9193d67e2c9db78bad21f8dc59fca0cacd8c1c3bb071bb16a852.js" integrity="sha256-/oPhG0&#43;8kZPWfiydt4utIfjcWfygys2MHDuwcbsWqFI=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  

















</body>
</html>
