<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=45315&amp;path=blog/livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Gradient boosting - Example R codes for BIOS 850 &amp; 880</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="yli8" />
  <meta name="description" content="" />

  <meta name="keywords" content="R codes, BIOS 850, BIOS 880" />






<meta name="generator" content="Hugo 0.126.1" />


<link rel="canonical" href="http://localhost:45315/blog/post/gb/" />





<link rel="icon" href="/blog/favicon.ico" />











<link rel="stylesheet" href="/blog/sass/jane.min.de22abc00de44766eebd1054fd9e0b254b071f89d5019044f893c484a9249a8d.css" integrity="sha256-3iKrwA3kR2buvRBU/Z4LJUsHH4nVAZBE&#43;JPEhKkkmo0=" media="screen" crossorigin="anonymous">







<meta property="og:url" content="http://localhost:45315/blog/post/gb/">
  <meta property="og:site_name" content="Example R codes for BIOS 850 &amp; 880">
  <meta property="og:title" content="Gradient boosting">
  <meta property="og:description" content="Example R codes for BIOS 850 &amp; 880">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-03-28T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-03-28T00:00:00+00:00">
    <meta property="article:tag" content="Gradient Boosting">

  <meta itemprop="name" content="Gradient boosting">
  <meta itemprop="description" content="Example R codes for BIOS 850 &amp; 880">
  <meta itemprop="datePublished" content="2024-03-28T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-03-28T00:00:00+00:00">
  <meta itemprop="wordCount" content="1735">
  <meta itemprop="keywords" content="Gradient Boosting">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Gradient boosting">
  <meta name="twitter:description" content="Example R codes for BIOS 850 &amp; 880">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Example R codes for BIOS 850 & 880</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/post/">Archives</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/tags/">Tags</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/categories/">Categories</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/about/">About</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/">external-link</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="http://localhost:45315/blog/">
              docs
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="http://localhost:45315/blog/post/ab/">AdaBoost</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/bcart/">Bagged Classification And Regression Trees（Bagged CART)</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/ct/">Classification trees</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/ca/">Cluster analysis</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/en/">Elastic Net</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/gb/">Gradient boosting</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/gbm/">Gradient Boosting Machine（GBM)</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/knn/">K Nearest Neighbors (KNN)</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/nb/">Naive Bayes</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/nn/">Neural network</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/rf/">Random forest</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/rt/">Regression trees</a>
              </li>
            
              <li>
                <a href="http://localhost:45315/blog/post/svm/">Support vector machine (SVM)</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      Example R codes for BIOS 850 & 880
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/post/">Archives</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/tags/">Tags</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/categories/">Categories</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/about/">About</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="http://localhost:45315/blog/">external-link</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          <a class="menu-item-link menu-parent" href="http://localhost:45315/blog/">docs</a>
          <ul class="submenu">
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/ab/">AdaBoost</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/bcart/">Bagged Classification And Regression Trees（Bagged CART)</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/ct/">Classification trees</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/ca/">Cluster analysis</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/en/">Elastic Net</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/gb/">Gradient boosting</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/gbm/">Gradient Boosting Machine（GBM)</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/knn/">K Nearest Neighbors (KNN)</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/nb/">Naive Bayes</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/nn/">Neural network</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/rf/">Random forest</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/rt/">Regression trees</a>
              </li>
            
              <li class="submenu-item">
                <a href="http://localhost:45315/blog/post/svm/">Support vector machine (SVM)</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight wallpaper">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Gradient boosting</h1>
      

      <div class="post-meta">
  <div class="post-meta-author">
    by
      yli8
    
  </div>

  <div class="post-meta-time">
    <time datetime="2024-03-28">
      2024-03-28
    </time>
  </div>

  


  <div class="post-meta__right">
    

    <div class="post-meta-category">
        <a href="http://localhost:45315/blog/categories/gradient-boosting/"> Gradient boosting </a>
          
      </div>


    
    


    
    
  </div>
</div>

    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#1-package-installation">1. Package installation</a></li>
    <li><a href="#data-reading-and-processing">Data Reading and processing</a></li>
    <li><a href="#gradient-boosting">Gradient boosting</a></li>
  </ul>
</nav>
  </div>
</div>


    
    <div class="post-content">
      <h2 id="1-package-installation">1. Package installation</h2>
<p>Here we primarily use the <code>xgboost</code> and <code>caret</code> packages.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">require</span>(xgboost)) <span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;xgboost&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">require</span>(caret)) <span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#34;caret&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(xgboost)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(caret)
</span></span></code></pre></div><h2 id="data-reading-and-processing">Data Reading and processing</h2>
<p>The data can be downloaded at wbdc.data and wbdc.names from the following address: <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/">http://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/</a></p>
<p>The data has been processed into panel data format. Upon inspection of the data structure, it was found that the first column is an ID column with no meaningful features and thus needs to be removed. The second column, &ldquo;diagnosis,&rdquo; is the response variable and is categorical. In R, for classification tasks, response variables are typically required to be of factor type, so data type conversion is needed. The remaining columns are predictor variables and are of numeric type.</p>
<p>The data has dimensions of 568 samples and 32 features (including the response feature).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>BreastCancer <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">read.csv</span>(<span style="color:#e6db74">&#34;wisc_bc_data.csv&#34;</span>, stringsAsFactors <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dim</span>(BreastCancer)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] 568  32</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">table</span>(BreastCancer<span style="color:#f92672">$</span>diagnosis)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   B   M </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 357 211</span>
</span></span></code></pre></div><p>Comparing the distribution of malignant and benign cases.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(reshape2)
</span></span><span style="display:flex;"><span>bc <span style="color:#f92672">&lt;-</span> BreastCancer[, <span style="color:#ae81ff">-1</span>]
</span></span><span style="display:flex;"><span>bc.melt <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">melt</span>(bc, id.var <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;diagnosis&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(bc.melt)
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   diagnosis    variable value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 1         M radius_mean 20.57</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 2         M radius_mean 19.69</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 3         M radius_mean 11.42</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 4         M radius_mean 20.29</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 5         M radius_mean 12.45</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 6         M radius_mean 18.25</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(data <span style="color:#f92672">=</span> bc.melt, <span style="color:#a6e22e">aes</span>(x <span style="color:#f92672">=</span> diagnosis, y <span style="color:#f92672">=</span> <span style="color:#a6e22e">log</span>(value <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>), fill <span style="color:#f92672">=</span> diagnosis)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_boxplot</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme_bw</span>() <span style="color:#f92672">+</span> <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>variable, ncol <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>)
</span></span></code></pre></div><p><img alt="Fig1" src="/blog/post/gb/640.webp"></p>
<p>The correlation between variables in the data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(tidyverse)
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(BreastCancer, <span style="color:#ae81ff">-1</span>) <span style="color:#f92672">%&gt;%</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mutate_at</span>(<span style="color:#e6db74">&#34;diagnosis&#34;</span>, as.factor)
</span></span><span style="display:flex;"><span>data[1<span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   diagnosis radius_mean texture_mean perimeter_mean area_mean</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 1         M       20.57        17.77         132.90    1326.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 2         M       19.69        21.25         130.00    1203.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 3         M       11.42        20.38          77.58     386.1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 4         M       20.29        14.34         135.10    1297.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 5         M       12.45        15.70          82.57     477.1</span>
</span></span><span style="display:flex;"><span>corrplot<span style="color:#f92672">::</span><span style="color:#a6e22e">corrplot</span>(<span style="color:#a6e22e">cor</span>(data[, <span style="color:#ae81ff">-1</span>]))
</span></span></code></pre></div><p><img alt="Fig1" src="/blog/post/gb/641.webp"></p>
<p>Split the raw data into training and testing datasets.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(sampling)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">123</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># </span>
</span></span><span style="display:flex;"><span>train_id <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">strata</span>(data, <span style="color:#e6db74">&#34;diagnosis&#34;</span>, size <span style="color:#f92672">=</span> <span style="color:#a6e22e">rev</span>(<span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">table</span>(data<span style="color:#f92672">$</span>diagnosis) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.7</span>)))<span style="color:#f92672">$</span>ID_unit
</span></span><span style="display:flex;"><span><span style="color:#75715e"># training data</span>
</span></span><span style="display:flex;"><span>train_data <span style="color:#f92672">&lt;-</span> data[train_id, ]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># test data</span>
</span></span><span style="display:flex;"><span>test_data <span style="color:#f92672">&lt;-</span> data[<span style="color:#f92672">-</span>train_id, ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># check proportions</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">prop.table</span>(<span style="color:#a6e22e">table</span>(train_data<span style="color:#f92672">$</span>diagnosis))
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##         B         M </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 0.6281407 0.3718593</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">prop.table</span>(<span style="color:#a6e22e">table</span>(test_data<span style="color:#f92672">$</span>diagnosis))
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##         B         M </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 0.6294118 0.3705882</span>
</span></span></code></pre></div><h2 id="gradient-boosting">Gradient boosting</h2>
<p>In this section, we will use the loaded xgboost package. As this method is highly effective, we will directly apply it to address the most challenging diagnostic problem of breast cancer. As mentioned in the introduction to boosting algorithms, we need to adjust some parameters:</p>
<p>nrounds: Maximum number of iterations (number of trees in the final model).
colsample_bytree: Ratio of features to randomly select when building a tree. Default value is 1 (using 100% of features).
min_child_weight: Minimum weight to be used when boosting trees. Default is 10.
eta: Learning rate, the contribution of each tree in the final solution. Default is 0.3.
gamma: Minimum loss reduction required to create a new leaf node in a tree.
subsample: Proportion of the observation data used for training each tree. Default value is 1 (100%).
max_depth: Maximum depth of a single tree.
You can use the expand.grid() function to create an experimental grid to run the training process of the caret package. For the parameters listed above, if specific values are not set, an error message will be received even if default values are available. The parameter values below are based on my previous training iterations. It is recommended to personally experiment with the parameter adjustment process. Use the following command to create the grid:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">###</span>
</span></span><span style="display:flex;"><span>grid <span style="color:#f92672">=</span> <span style="color:#a6e22e">expand.grid</span>(
</span></span><span style="display:flex;"><span>  nrounds <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">100</span>),
</span></span><span style="display:flex;"><span>  colsample_bytree <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  min_child_weight <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>  eta <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.01</span>, <span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.3</span>), <span style="color:#75715e">#0.3 is default,</span>
</span></span><span style="display:flex;"><span>  gamma <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">0.25</span>),
</span></span><span style="display:flex;"><span>  subsample <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>,
</span></span><span style="display:flex;"><span>  max_depth <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>grid
</span></span><span style="display:flex;"><span><span style="color:#75715e">##    nrounds colsample_bytree min_child_weight  eta gamma subsample max_depth</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 1       75                1                1 0.01  0.50       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 2      100                1                1 0.01  0.50       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 3       75                1                1 0.10  0.50       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 4      100                1                1 0.10  0.50       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 5       75                1                1 0.30  0.50       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 6      100                1                1 0.30  0.50       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 7       75                1                1 0.01  0.25       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 8      100                1                1 0.01  0.25       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 9       75                1                1 0.10  0.25       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10     100                1                1 0.10  0.25       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 11      75                1                1 0.30  0.25       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 12     100                1                1 0.30  0.25       0.5         2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 13      75                1                1 0.01  0.50       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 14     100                1                1 0.01  0.50       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 15      75                1                1 0.10  0.50       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 16     100                1                1 0.10  0.50       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 17      75                1                1 0.30  0.50       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 18     100                1                1 0.30  0.50       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 19      75                1                1 0.01  0.25       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 20     100                1                1 0.01  0.25       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 21      75                1                1 0.10  0.25       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 22     100                1                1 0.10  0.25       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 23      75                1                1 0.30  0.25       0.5         3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 24     100                1                1 0.30  0.25       0.5         3</span>
</span></span></code></pre></div><p><strong>Cross validation</strong></p>
<p>Before using the train() function from the caret package, I need to create an object named &ldquo;cntrl&rdquo; to set the parameters of trainControl. This object will store the method we want to use for training and tuning parameters. We will use 10-fold cross-validation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>cntrl <span style="color:#f92672">=</span> <span style="color:#a6e22e">trainControl</span>(method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cv&#34;</span>, number <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>, verboseIter <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>, returnData <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>,
</span></span><span style="display:flex;"><span>    returnResamp <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;final&#34;</span>)
</span></span></code></pre></div><p><strong>Building model</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">123</span>)
</span></span><span style="display:flex;"><span>train.xgb <span style="color:#f92672">=</span> <span style="color:#a6e22e">train</span>(x <span style="color:#f92672">=</span> train_data[, <span style="color:#ae81ff">-1</span>], y <span style="color:#f92672">=</span> train_data[, <span style="color:#ae81ff">1</span>], trControl <span style="color:#f92672">=</span> cntrl, tuneGrid <span style="color:#f92672">=</span> grid,
</span></span><span style="display:flex;"><span>    method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;xgbTree&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>train.xgb
</span></span><span style="display:flex;"><span><span style="color:#75715e">## eXtreme Gradient Boosting </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## No pre-processing</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Resampling: Cross-Validated (10 fold) </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Summary of sample sizes: 359, 358, 358, 358, 358, 359, ... </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Resampling results across tuning parameters:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   eta   max_depth  gamma  nrounds  Accuracy   Kappa    </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.01  2          0.25    75      0.9448077  0.8815793</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.01  2          0.25   100      0.9448718  0.8825558</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.01  2          0.50    75      0.9448077  0.8811347</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.01  2          0.50   100      0.9448077  0.8814371</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.01  3          0.25    75      0.9498718  0.8926807</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.01  3          0.25   100      0.9473077  0.8868425</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.01  3          0.50    75      0.9448077  0.8815793</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.01  3          0.50   100      0.9473077  0.8868425</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.10  2          0.25    75      0.9623718  0.9187054</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.10  2          0.25   100      0.9598718  0.9133019</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.10  2          0.50    75      0.9548077  0.9022024</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.10  2          0.50   100      0.9623718  0.9192980</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.10  3          0.25    75      0.9648718  0.9247034</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.10  3          0.25   100      0.9673718  0.9298262</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.10  3          0.50    75      0.9548077  0.9022182</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.10  3          0.50   100      0.9598718  0.9128120</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.30  2          0.25    75      0.9623718  0.9190002</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.30  2          0.25   100      0.9648718  0.9241266</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.30  2          0.50    75      0.9623077  0.9184364</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.30  2          0.50   100      0.9598077  0.9133136</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.30  3          0.25    75      0.9649359  0.9247785</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.30  3          0.25   100      0.9699359  0.9357355</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.30  3          0.50    75      0.9748718  0.9457522</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   0.30  3          0.50   100      0.9748718  0.9457522</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Tuning parameter &#39;colsample_bytree&#39; was held constant at a value of 1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Tuning parameter &#39;min_child_weight&#39; was held constant at a value of 1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Tuning parameter &#39;subsample&#39; was held constant at a value of 0.5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Accuracy was used to select the optimal model using the largest value.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## The final values used for the model were nrounds = 75, max_depth = 3, eta</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  = 0.3, gamma = 0.5, colsample_bytree = 1, min_child_weight = 1 and subsample</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  = 0.5.</span>
</span></span></code></pre></div><p><strong>Optimal parameters</strong></p>
<p>From this, we can obtain the optimal parameter combination to build the model. The accuracy of the model on the training data is 0.975, and the Kappa value is 0.946. The next steps are a bit complicated, but I believe this is the best practice. First, create a parameter list for use by the xgb.train() function from the xgboost package. Then, convert the data frame into an input feature matrix and a labeled numeric result list (where the values are 0 and 1). Next, combine the feature matrix and label list into the required input, which is an xgb.DMatrix object.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>param <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">list</span>(objective <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;binary:logistic&#34;</span>, booster <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gbtree&#34;</span>, eval_metric <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;error&#34;</span>,
</span></span><span style="display:flex;"><span>    eta <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>, max_depth <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>, subsample <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>, colsample_bytree <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, gamma <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.matrix</span>(train_data[, <span style="color:#ae81ff">-1</span>])
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ifelse</span>(train_data<span style="color:#f92672">$</span>diagnosis <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;B&#34;</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>train.mat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">xgb.DMatrix</span>(data <span style="color:#f92672">=</span> x, label <span style="color:#f92672">=</span> y)
</span></span></code></pre></div><p>** Model optimization **</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">123</span>)
</span></span><span style="display:flex;"><span>xgb.fit <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">xgb.train</span>(params <span style="color:#f92672">=</span> param, data <span style="color:#f92672">=</span> train.mat, nrounds <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>xgb.fit
</span></span><span style="display:flex;"><span><span style="color:#75715e">## ##### xgb.Booster</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## raw: 87 Kb </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## call:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   xgb.train(params = param, data = train.mat, nrounds = 100)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## params (as set within xgb.train):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   objective = &#34;binary:logistic&#34;, booster = &#34;gbtree&#34;, eval_metric = &#34;error&#34;, eta = &#34;0.1&#34;, max_depth = &#34;2&#34;, subsample = &#34;0.5&#34;, colsample_bytree = &#34;1&#34;, gamma = &#34;0.5&#34;, validate_parameters = &#34;TRUE&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## xgb.attributes:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   niter</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## callbacks:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##   cb.print.evaluation(period = print_every_n)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## # of features: 30 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## niter: 100</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## nfeatures : 30</span>
</span></span></code></pre></div><p><strong>Visualizing Variables</strong></p>
<p>From the graph, we can see that the proportion of the top few important variables almost reaches 0.3. This threshold was set in the previous grid as: eta = c(0.01, 0.1, 0.3), #0.3 is default.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>impMatrix <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">xgb.importance</span>(feature_names <span style="color:#f92672">=</span> <span style="color:#a6e22e">dimnames</span>(x)[[2]], model <span style="color:#f92672">=</span> xgb.fit)
</span></span><span style="display:flex;"><span>impMatrix
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                     Feature         Gain       Cover   Frequency</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  1:    concave_points_worst 0.2967527144 0.147574780 0.074766355</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  2:     concave_points_mean 0.2341084307 0.144084708 0.079439252</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  3:            radius_worst 0.0776151887 0.075881804 0.056074766</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  4:         perimeter_worst 0.0742989918 0.080783308 0.065420561</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  5:                 area_se 0.0707442192 0.075966262 0.065420561</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  6:           texture_worst 0.0431688078 0.084473059 0.107476636</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  7:              area_worst 0.0349753102 0.054806620 0.056074766</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  8:         concavity_worst 0.0274044659 0.045700578 0.060747664</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##  9:            texture_mean 0.0242682068 0.042618830 0.056074766</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 10:        smoothness_worst 0.0180421347 0.030139745 0.046728972</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 11:               area_mean 0.0137108659 0.022756702 0.018691589</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 12:          compactne_mean 0.0105402518 0.012610045 0.028037383</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 13:             symmetry_se 0.0104209161 0.020799297 0.042056075</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 14:         smoothness_mean 0.0090815731 0.020561037 0.032710280</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 15:               radius_se 0.0084606195 0.029712377 0.018691589</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 16:            compactne_se 0.0080685708 0.014326525 0.032710280</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 17:          symmetry_worst 0.0076659203 0.027927952 0.037383178</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 18:  fractal_dimension_mean 0.0057942369 0.008967406 0.014018692</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 19:           smoothness_se 0.0050382309 0.018076694 0.023364486</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 20:    fractal_dimension_se 0.0043507637 0.007250846 0.018691589</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 21: fractal_dimension_worst 0.0029493268 0.006075975 0.009345794</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 22:           symmetry_mean 0.0026459958 0.006109480 0.014018692</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 23:          concavity_mean 0.0023260374 0.003932079 0.009345794</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 24:          perimeter_mean 0.0022726213 0.003359381 0.004672897</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 25:         compactne_worst 0.0019021532 0.003878213 0.009345794</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 26:       concave_points_se 0.0011308883 0.002550426 0.004672897</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 27:             radius_mean 0.0010039937 0.002045465 0.004672897</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 28:            perimeter_se 0.0008485220 0.002095077 0.004672897</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 29:              texture_se 0.0004100425 0.004935332 0.004672897</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">##                     Feature         Gain       Cover   Frequency</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xgb.plot.importance</span>(impMatrix, main <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Gain by Feature&#34;</span>)
</span></span></code></pre></div><p><img alt="Fig1" src="/blog/post/gb/642.webp"></p>
<p><strong>Model evaluation</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(InformationValue)
</span></span><span style="display:flex;"><span>pred <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(xgb.fit, x)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">optimalCutoff</span>(y, pred)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] 0.2692855</span>
</span></span></code></pre></div><p><strong>Validation on test dataset</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>testMat <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as.matrix</span>(test_data[, <span style="color:#ae81ff">-1</span>])
</span></span><span style="display:flex;"><span>xgb.test <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">predict</span>(xgb.fit, testMat)
</span></span><span style="display:flex;"><span>y.test <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">ifelse</span>(test_data<span style="color:#f92672">$</span>diagnosis <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;B&#34;</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">optimalCutoff</span>(y.test, xgb.test)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] 0.1793153</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">confusionMatrix</span>(y.test, xgb.test, threshold <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.29</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">##     0  1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 0 103  0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 1   4 63</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">misClassError</span>(y.test, xgb.test, threshold <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.29</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">## [1] 0.9765</span>
</span></span></code></pre></div><p><strong>ROC curves</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e">###</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(InformationValue)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plotROC</span>(y.test, xgb.test)
</span></span></code></pre></div><p><img alt="Fig1" src="/blog/post/gb/643.webp"></p>
    </div>

    
    



    
    


    <footer class="post-footer">
      <div class="post-tags">
          <a href="http://localhost:45315/blog/tags/gradient-boosting/">Gradient boosting</a>
            
        </div>


      
      <nav class="post-nav">
        
          <a class="prev" href="/blog/post/nn/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Neural network</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="/blog/post/rf/">
            <span class="next-text nav-default">Random forest</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  


  
  

  

  
  

  
  

  

  

    

  

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:lyqglyqg@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="http://lyqg.github.io/" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="http://localhost:45315/blog/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
  
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2023 -
    2024
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        lyqg
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/blog/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/blog/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/blog/js/main.fe83e11b4fbc9193d67e2c9db78bad21f8dc59fca0cacd8c1c3bb071bb16a852.js" integrity="sha256-/oPhG0&#43;8kZPWfiydt4utIfjcWfygys2MHDuwcbsWqFI=" crossorigin="anonymous"></script>



  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>









  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  

















</body>
</html>
